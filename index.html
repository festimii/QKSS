<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>IMAP</title>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      crossorigin="anonymous"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <link
      rel="stylesheet"
      href="https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/leaflet.fullscreen.css"
    />

    <link rel="stylesheet" href="style.css" />
  </head>
  <body class="d-flex flex-column vh-100">
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container-fluid">
        <a class="navbar-brand d-flex align-items-center" href="/">
          <img
            src="KCSS-logo.svg"
            alt="KCSS logo"
            height="40"
            class="me-2"
          />
          <span>QKSS Map</span>
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navMenu"
          aria-controls="navMenu"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-end" id="navMenu">
          <div class="d-flex align-items-center gap-2">
            <div class="nav-item">
              <button class="btn btn-outline-light" data-bs-toggle="modal" data-bs-target="#aboutModal">About</button>
            </div>
            <div class="nav-item dropdown ms-2">
              <a
                class="nav-link dropdown-toggle text-light"
                href="#"
                id="langDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                <i class="bi bi-translate"></i>
              </a>
              <ul
                class="dropdown-menu dropdown-menu-end"
                aria-labelledby="langDropdown"
              >
                <li>
                  <button class="dropdown-item lang-option" data-lang="en">
                    English
                  </button>
                </li>
                <li>
                  <button class="dropdown-item lang-option" data-lang="sq">
                    Shqip
                  </button>
                </li>
                <li>
                  <button class="dropdown-item lang-option" data-lang="sr">
                    Srpski
                  </button>
                </li>
              </ul>
            </div>
            <button class="btn btn-outline-light" id="toggleSidebar">
              <i class="bi bi-layout-sidebar"></i>
            </button>
          </div>
        </div>
      </div>
    </nav>

    <div class="flex-grow-1 d-flex overflow-hidden">
      <aside
        id="sidebar"
        class="bg-light border-end p-3 overflow-auto"
        style="width: 280px"
      >
        <h5>Locations <i class="bi bi-geo-alt-fill text-primary"></i></h5>
        <div class="mb-3">
          <label class="form-label">From</label>
          <input type="date" id="startDate" class="form-control" />
        </div>
        <div class="mb-3">
          <label class="form-label">To</label>
          <input type="date" id="endDate" class="form-control" />
        </div>
        <div class="mb-3">
          <strong>Categories</strong>
          <div class="form-check">
            <input class="form-check-input category-input" type="checkbox" value="violent" id="catViolent" />
            <label class="form-check-label" for="catViolent">üî¥ Violent Incidents</label>
          </div>
          <div class="form-check">
            <input class="form-check-input category-input" type="checkbox" value="hate" id="catHate" />
            <label class="form-check-label" for="catHate">üî¥ Hate Speech &amp; Provocative Statements</label>
          </div>
          <div class="form-check">
            <input class="form-check-input category-input" type="checkbox" value="obstruction" id="catObstruction" />
            <label class="form-check-label" for="catObstruction">üî¥ Institutional Obstruction</label>
          </div>
          <div class="form-check">
            <input class="form-check-input category-input" type="checkbox" value="cooperation" id="catCooperation" />
            <label class="form-check-label" for="catCooperation">üü¢ Interethnic Cooperation Initiatives</label>
          </div>
          <div class="form-check">
            <input class="form-check-input category-input" type="checkbox" value="dialogues" id="catDialogues" />
            <label class="form-check-label" for="catDialogues">üü¢ Community Dialogues &amp; Roundtables</label>
          </div>
          <div class="form-check">
            <input class="form-check-input category-input" type="checkbox" value="policy" id="catPolicy" />
            <label class="form-check-label" for="catPolicy">üü¢ Inclusive Policy Measures</label>
          </div>
          <div class="form-check">
            <input class="form-check-input category-input" type="checkbox" value="arrests" id="catArrests" />
            <label class="form-check-label" for="catArrests">‚öñÔ∏è Arrests &amp; Legal Actions</label>
          </div>
          <div class="form-check">
            <input class="form-check-input category-input" type="checkbox" value="reports" id="catReports" />
            <label class="form-check-label" for="catReports">‚öñÔ∏è Reports &amp; Statements Published</label>
          </div>
          <div class="form-check">
            <input class="form-check-input category-input" type="checkbox" value="interventions" id="catInterventions" />
            <label class="form-check-label" for="catInterventions">‚öñÔ∏è Government or International Interventions</label>
          </div>
        </div>
        <input
          type="text"
          id="searchInput"
          class="form-control mb-3"
          placeholder="Filter by title..."
        />
        <ul id="pinList" class="list-group"></ul>
        <hr />
      </aside>

      <div id="map" class="flex-grow-1 position-relative"></div>
    </div>

    <div class="modal fade" id="pinModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="pinModalTitle"></h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <p id="pinDescription" class="mb-2 lead"></p>
            <p class="text-muted mb-3">
              <strong id="cityLabel">Location:</strong>
              <span id="pinCity"></span>
            </p>
            <div class="mt-3 d-flex gap-2">
              <a id="modalReadMore" href="#" class="btn btn-primary" target="_blank">Read more</a>
              <button class="btn btn-outline-secondary" onclick="copyModalLink()">Copy Link</button>
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-secondary"
              data-bs-dismiss="modal"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- About modal -->
    <div class="modal fade" id="aboutModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">About</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
          </div>
          <div class="modal-body">
            <p id="aboutText">This platform displays interethnic events across Kosovo.</p>
          </div>
        </div>
      </div>
    </div>

    <footer class="bg-dark text-light text-center py-2">
      <small>¬© 2025 QKSS Map Viewer. Data sourced from our API.<br>
      This site is part of a project supported by NED (National Endowment for Democracy), titled ‚ÄòIncreasing Government Transparency and Accountability in Interethnic Dialogue,‚Äô and implemented by KCSS. The authors wrote the specific chapters within their own capacities. As such, the views presented in this site do not necessarily reflect the views of KCSS or NED.</small>
    </footer>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      crossorigin="anonymous"
    ></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/Leaflet.fullscreen.min.js"></script>
    <script src="config.js"></script>
    <script src="app.js"></script>
  </body>
</html>
